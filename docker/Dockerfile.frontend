# --- build stage ---
    FROM node:20-alpine AS build
    WORKDIR /app
    COPY frontend/package*.json ./
    RUN npm ci
    COPY frontend .
    ENV NODE_ENV=production
    # Make sure your code uses VITE_API_URL (see Step 3)
    RUN npm run build
    
    # --- runtime stage (Caddy serves /usr/share/caddy) ---
    FROM caddy:2-alpine
    COPY --from=build /app/dist /usr/share/caddy
    # Caddyfile will be mounted by compose